<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>upkie: upkie::cpp::spine::Spine Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">upkie<span id="projectnumber">&#160;5.2.0</span>
   </div>
   <div id="projectbrief">Open-source wheeled biped robots</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classupkie_1_1cpp_1_1spine_1_1Spine.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classupkie_1_1cpp_1_1spine_1_1Spine-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">upkie::cpp::spine::Spine Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Loop transmitting actions to the actuation and observations to the agent.  
 <a href="classupkie_1_1cpp_1_1spine_1_1Spine.html#details">More...</a></p>

<p><code>#include &lt;Spine.h&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structupkie_1_1cpp_1_1spine_1_1Spine_1_1Parameters.html">Parameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html" title="Loop transmitting actions to the actuation and observations to the agent.">Spine</a> parameters.  <a href="structupkie_1_1cpp_1_1spine_1_1Spine_1_1Parameters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a83da2c72142bb3752d8efde30a4a1ae9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a83da2c72142bb3752d8efde30a4a1ae9">Spine</a> (const <a class="el" href="structupkie_1_1cpp_1_1spine_1_1Spine_1_1Parameters.html">Parameters</a> &amp;params, <a class="el" href="classupkie_1_1cpp_1_1actuation_1_1Interface.html">actuation::Interface</a> &amp;interface, <a class="el" href="classupkie_1_1cpp_1_1observers_1_1ObserverPipeline.html">ObserverPipeline</a> &amp;observers)</td></tr>
<tr class="memdesc:a83da2c72142bb3752d8efde30a4a1ae9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize spine.  <a href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a83da2c72142bb3752d8efde30a4a1ae9">More...</a><br /></td></tr>
<tr class="separator:a83da2c72142bb3752d8efde30a4a1ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7353a5b0b885f5cfe867f80ddfc5cc15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a7353a5b0b885f5cfe867f80ddfc5cc15">reset</a> (const palimpsest::Dictionary &amp;config)</td></tr>
<tr class="memdesc:a7353a5b0b885f5cfe867f80ddfc5cc15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the spine with a new configuration.  <a href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a7353a5b0b885f5cfe867f80ddfc5cc15">More...</a><br /></td></tr>
<tr class="separator:a7353a5b0b885f5cfe867f80ddfc5cc15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fbc3f0c7528609e1060b1f98e6303e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a5fbc3f0c7528609e1060b1f98e6303e0">run</a> ()</td></tr>
<tr class="memdesc:a5fbc3f0c7528609e1060b1f98e6303e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the spine loop until termination.  <a href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a5fbc3f0c7528609e1060b1f98e6303e0">More...</a><br /></td></tr>
<tr class="separator:a5fbc3f0c7528609e1060b1f98e6303e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a564f4bcb90717fdce3a3f8e8151808b7"><td class="memItemLeft" align="right" valign="top"><a id="a564f4bcb90717fdce3a3f8e8151808b7" name="a564f4bcb90717fdce3a3f8e8151808b7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>cycle</b> ()</td></tr>
<tr class="memdesc:a564f4bcb90717fdce3a3f8e8151808b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spin one cycle of the spine loop. <br /></td></tr>
<tr class="separator:a564f4bcb90717fdce3a3f8e8151808b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4dc94863ef5d92beddc436013bb3af1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#ad4dc94863ef5d92beddc436013bb3af1">simulate</a> (unsigned nb_substeps)</td></tr>
<tr class="memdesc:ad4dc94863ef5d92beddc436013bb3af1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alternative to <a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a5fbc3f0c7528609e1060b1f98e6303e0">run</a> where the actuation interface is cycled a fixed number of times, and communication cycles are not frequency-regulated.  <a href="classupkie_1_1cpp_1_1spine_1_1Spine.html#ad4dc94863ef5d92beddc436013bb3af1">More...</a><br /></td></tr>
<tr class="separator:ad4dc94863ef5d92beddc436013bb3af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae769f14f84551fe7ce8d070ba41f453b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#ae769f14f84551fe7ce8d070ba41f453b">cycle_actuation</a> ()</td></tr>
<tr class="memdesc:ae769f14f84551fe7ce8d070ba41f453b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spin one cycle of communications with the actuation interface.  <a href="classupkie_1_1cpp_1_1spine_1_1Spine.html#ae769f14f84551fe7ce8d070ba41f453b">More...</a><br /></td></tr>
<tr class="separator:ae769f14f84551fe7ce8d070ba41f453b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ae7dec84fed2918a6e66e42659bb3f37f"><td class="memItemLeft" align="right" valign="top"><a id="ae7dec84fed2918a6e66e42659bb3f37f" name="ae7dec84fed2918a6e66e42659bb3f37f"></a>
const unsigned&#160;</td><td class="memItemRight" valign="bottom"><b>frequency_</b></td></tr>
<tr class="memdesc:ae7dec84fed2918a6e66e42659bb3f37f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frequency of the spine loop in [Hz]. <br /></td></tr>
<tr class="separator:ae7dec84fed2918a6e66e42659bb3f37f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c7408dcd2a6ca032ba49d3b39e1b5b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classupkie_1_1cpp_1_1actuation_1_1Interface.html">actuation::Interface</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a38c7408dcd2a6ca032ba49d3b39e1b5b">actuation_</a></td></tr>
<tr class="memdesc:a38c7408dcd2a6ca032ba49d3b39e1b5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface that communicates with actuators.  <a href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a38c7408dcd2a6ca032ba49d3b39e1b5b">More...</a><br /></td></tr>
<tr class="separator:a38c7408dcd2a6ca032ba49d3b39e1b5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4394830266dedbd787a235f85e2382a2"><td class="memItemLeft" align="right" valign="top"><a id="a4394830266dedbd787a235f85e2382a2" name="a4394830266dedbd787a235f85e2382a2"></a>
<a class="el" href="classupkie_1_1cpp_1_1spine_1_1AgentInterface.html">AgentInterface</a>&#160;</td><td class="memItemRight" valign="bottom"><b>agent_interface_</b></td></tr>
<tr class="memdesc:a4394830266dedbd787a235f85e2382a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shared memory mapping for inter-process communication. <br /></td></tr>
<tr class="separator:a4394830266dedbd787a235f85e2382a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c560a2be884b4ceafd8fd70fcc3c17"><td class="memItemLeft" align="right" valign="top"><a id="a82c560a2be884b4ceafd8fd70fcc3c17" name="a82c560a2be884b4ceafd8fd70fcc3c17"></a>
std::future&lt; Output &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>actuation_output_</b></td></tr>
<tr class="memdesc:a82c560a2be884b4ceafd8fd70fcc3c17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Future used to wait for moteus replies. <br /></td></tr>
<tr class="separator:a82c560a2be884b4ceafd8fd70fcc3c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1819d0c5ae91f2d7d38ab8e8c09337d"><td class="memItemLeft" align="right" valign="top"><a id="aa1819d0c5ae91f2d7d38ab8e8c09337d" name="aa1819d0c5ae91f2d7d38ab8e8c09337d"></a>
std::vector&lt; ServoReply &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>servo_replies_</b></td></tr>
<tr class="memdesc:aa1819d0c5ae91f2d7d38ab8e8c09337d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Latest servo replies. They are copied and thread-safe. <br /></td></tr>
<tr class="separator:aa1819d0c5ae91f2d7d38ab8e8c09337d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1309d03c283a73e687d6faf914e28075"><td class="memItemLeft" align="right" valign="top"><a id="a1309d03c283a73e687d6faf914e28075" name="a1309d03c283a73e687d6faf914e28075"></a>
palimpsest::Dictionary&#160;</td><td class="memItemRight" valign="bottom"><b>working_dict_</b></td></tr>
<tr class="memdesc:a1309d03c283a73e687d6faf914e28075"><td class="mdescLeft">&#160;</td><td class="mdescRight">All data from observation to action goes to this dictionary. <br /></td></tr>
<tr class="separator:a1309d03c283a73e687d6faf914e28075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf43139bee03e3d0c800820d70d1146a"><td class="memItemLeft" align="right" valign="top"><a id="adf43139bee03e3d0c800820d70d1146a" name="adf43139bee03e3d0c800820d70d1146a"></a>
<a class="el" href="classupkie_1_1cpp_1_1observers_1_1ObserverPipeline.html">ObserverPipeline</a>&#160;</td><td class="memItemRight" valign="bottom"><b>observer_pipeline_</b></td></tr>
<tr class="memdesc:adf43139bee03e3d0c800820d70d1146a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pipeline of observers, executed in that order. <br /></td></tr>
<tr class="separator:adf43139bee03e3d0c800820d70d1146a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9539ece52397a9b969a90c3749402719"><td class="memItemLeft" align="right" valign="top"><a id="a9539ece52397a9b969a90c3749402719" name="a9539ece52397a9b969a90c3749402719"></a>
mpacklog::Logger&#160;</td><td class="memItemRight" valign="bottom"><b>logger_</b></td></tr>
<tr class="memdesc:a9539ece52397a9b969a90c3749402719"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logger for the <a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a1309d03c283a73e687d6faf914e28075">working_dict_</a> produced at each cycle. <br /></td></tr>
<tr class="separator:a9539ece52397a9b969a90c3749402719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad04eefbac89635e7a7064eed1e3a6891"><td class="memItemLeft" align="right" valign="top"><a id="ad04eefbac89635e7a7064eed1e3a6891" name="ad04eefbac89635e7a7064eed1e3a6891"></a>
std::vector&lt; char &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ipc_buffer_</b></td></tr>
<tr class="memdesc:ad04eefbac89635e7a7064eed1e3a6891"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer used to serialize/deserialize dictionaries in IPC. <br /></td></tr>
<tr class="separator:ad04eefbac89635e7a7064eed1e3a6891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc52b0894bdb91bec8c7502edadad095"><td class="memItemLeft" align="right" valign="top"><a id="acc52b0894bdb91bec8c7502edadad095" name="acc52b0894bdb91bec8c7502edadad095"></a>
const bool &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>caught_interrupt_</b></td></tr>
<tr class="memdesc:acc52b0894bdb91bec8c7502edadad095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean flag that becomes true when an interruption is caught. <br /></td></tr>
<tr class="separator:acc52b0894bdb91bec8c7502edadad095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e9f05bfa0e9a42803e3b74849037b63"><td class="memItemLeft" align="right" valign="top"><a id="a1e9f05bfa0e9a42803e3b74849037b63" name="a1e9f05bfa0e9a42803e3b74849037b63"></a>
<a class="el" href="classupkie_1_1cpp_1_1spine_1_1StateMachine.html">StateMachine</a>&#160;</td><td class="memItemRight" valign="bottom"><b>state_machine_</b></td></tr>
<tr class="memdesc:a1e9f05bfa0e9a42803e3b74849037b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal state machine. <br /></td></tr>
<tr class="separator:a1e9f05bfa0e9a42803e3b74849037b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa0d3615a37e3cfdc2a7c399d89bd81c"><td class="memItemLeft" align="right" valign="top"><a id="aaa0d3615a37e3cfdc2a7c399d89bd81c" name="aaa0d3615a37e3cfdc2a7c399d89bd81c"></a>
<a class="el" href="namespaceupkie_1_1cpp_1_1spine.html#a9311be84959bd01ddbcde3f745c9f30e">State</a>&#160;</td><td class="memItemRight" valign="bottom"><b>state_cycle_beginning_</b></td></tr>
<tr class="memdesc:aaa0d3615a37e3cfdc2a7c399d89bd81c"><td class="mdescLeft">&#160;</td><td class="mdescRight">State after the last <a class="el" href="namespaceupkie_1_1cpp_1_1spine.html#a01571f65879785e2b8eced28593fc710a6271e28ff352965b1a52163c2c9c2e2b" title="Beginning of a spine cycle.">Event::kCycleBeginning</a>. <br /></td></tr>
<tr class="separator:aaa0d3615a37e3cfdc2a7c399d89bd81c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f13f2bb749448f910f5006eccc21718"><td class="memItemLeft" align="right" valign="top"><a id="a8f13f2bb749448f910f5006eccc21718" name="a8f13f2bb749448f910f5006eccc21718"></a>
<a class="el" href="namespaceupkie_1_1cpp_1_1spine.html#a9311be84959bd01ddbcde3f745c9f30e">State</a>&#160;</td><td class="memItemRight" valign="bottom"><b>state_cycle_end_</b></td></tr>
<tr class="memdesc:a8f13f2bb749448f910f5006eccc21718"><td class="mdescLeft">&#160;</td><td class="mdescRight">State after the last <a class="el" href="namespaceupkie_1_1cpp_1_1spine.html#a01571f65879785e2b8eced28593fc710a9a0848af36001f2871702e16c321aa16" title="End of a spine cycle.">Event::kCycleEnd</a>. <br /></td></tr>
<tr class="separator:a8f13f2bb749448f910f5006eccc21718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a293d216074467204027cc730b0294603"><td class="memItemLeft" align="right" valign="top"><a id="a293d216074467204027cc730b0294603" name="a293d216074467204027cc730b0294603"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>rx_count_</b></td></tr>
<tr class="memdesc:a293d216074467204027cc730b0294603"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of actuation replies received during the latest cycle. <br /></td></tr>
<tr class="separator:a293d216074467204027cc730b0294603"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Loop transmitting actions to the actuation and observations to the agent. </p>
<p >The spine acts as the intermediary between the actuation interface (e.g. moteus servos connected to the CAN-FD bus) and an agent communicating over shared memory (the agent interface). It packs observations to the agent from actuation replies and commands to the actuation from agent actions.</p>
<p >The spine processes requests at the beginning and end of each control cycle according to its <a class="el" href="classupkie_1_1cpp_1_1spine_1_1StateMachine.html" title="Spine state machine.">StateMachine</a>. The overall specification of the state machine is summarized in the following diagram:</p>
<div class="image">
<img src="state-machine.png" alt=""/>
</div>
 <p >See <a class="el" href="classupkie_1_1cpp_1_1spine_1_1StateMachine.html" title="Spine state machine.">StateMachine</a> for more details. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a83da2c72142bb3752d8efde30a4a1ae9" name="a83da2c72142bb3752d8efde30a4a1ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83da2c72142bb3752d8efde30a4a1ae9">&#9670;&#160;</a></span>Spine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upkie::cpp::spine::Spine::Spine </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structupkie_1_1cpp_1_1spine_1_1Spine_1_1Parameters.html">Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classupkie_1_1cpp_1_1actuation_1_1Interface.html">actuation::Interface</a> &amp;&#160;</td>
          <td class="paramname"><em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classupkie_1_1cpp_1_1observers_1_1ObserverPipeline.html">ObserverPipeline</a> &amp;&#160;</td>
          <td class="paramname"><em>observers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize spine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">params</td><td><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html" title="Loop transmitting actions to the actuation and observations to the agent.">Spine</a> parameters. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">interface</td><td>Interface to actuators. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">observers</td><td>Pipeline of observers to run, in that order, at each cycle. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae769f14f84551fe7ce8d070ba41f453b" name="ae769f14f84551fe7ce8d070ba41f453b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae769f14f84551fe7ce8d070ba41f453b">&#9670;&#160;</a></span>cycle_actuation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void upkie::cpp::spine::Spine::cycle_actuation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Spin one cycle of communications with the actuation interface. </p>
<p >A cycle consists in:</p>
<ol type="1">
<li>Run the observer pipeline over the latest reply</li>
<li>Prepare servo commands</li>
<li>Wait to receive the reply from the previous cycle over the interface</li>
<li>If applicable, start the next cycle: </li>
</ol>

</div>
</div>
<a id="a7353a5b0b885f5cfe867f80ddfc5cc15" name="a7353a5b0b885f5cfe867f80ddfc5cc15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7353a5b0b885f5cfe867f80ddfc5cc15">&#9670;&#160;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void upkie::cpp::spine::Spine::reset </td>
          <td>(</td>
          <td class="paramtype">const palimpsest::Dictionary &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the spine with a new configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">config</td><td>New global configuration dictionary, used to derive the servo layout (which servo is on which bus, corresponds to which joint) and forwarded to other components (e.g. observers). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5fbc3f0c7528609e1060b1f98e6303e0" name="a5fbc3f0c7528609e1060b1f98e6303e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fbc3f0c7528609e1060b1f98e6303e0">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void upkie::cpp::spine::Spine::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the spine loop until termination. </p>
<p >Each iteration of the loop runs observers, computes the action and cycles the actuation interface. Additionally, this function collects debug values and logs everything.</p>
<dl class="section note"><dt>Note</dt><dd>The spine will catch keyboard interrupts once this function is called. </dd></dl>

</div>
</div>
<a id="ad4dc94863ef5d92beddc436013bb3af1" name="ad4dc94863ef5d92beddc436013bb3af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4dc94863ef5d92beddc436013bb3af1">&#9670;&#160;</a></span>simulate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void upkie::cpp::spine::Spine::simulate </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>nb_substeps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alternative to <a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html#a5fbc3f0c7528609e1060b1f98e6303e0">run</a> where the actuation interface is cycled a fixed number of times, and communication cycles are not frequency-regulated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nb_substeps</td><td>Number of actuation cycles per action.</td></tr>
  </table>
  </dd>
</dl>
<p>Thus function assumes the agent alternates acting and observing. Simulation steps are triggered at startup (to construct the initial observation) and at each action request.</p>
<dl class="section note"><dt>Note</dt><dd>As its name suggests, do not use this function on a real robot.</dd></dl>
<p>Note that there is currently a delay of three substeps between observation and simulation. That is, the internal simulation state is always three substeps ahead compared to the values written to the observation dictionary when cycling the actuation. This decision is discussed in <a href="https://github.com/orgs/upkie/discussions/238#discussioncomment-8984290">https://github.com/orgs/upkie/discussions/238#discussioncomment-8984290</a> </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a38c7408dcd2a6ca032ba49d3b39e1b5b" name="a38c7408dcd2a6ca032ba49d3b39e1b5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38c7408dcd2a6ca032ba49d3b39e1b5b">&#9670;&#160;</a></span>actuation_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classupkie_1_1cpp_1_1actuation_1_1Interface.html">actuation::Interface</a>&amp; upkie::cpp::spine::Spine::actuation_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Interface that communicates with actuators. </p>
<p >The actuation interface communicates over the CAN-FD bus on real robots. Otherwise, it can be for instance a mock or a simulator interface. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>upkie/cpp/spine/Spine.h</li>
<li>upkie/cpp/spine/Spine.cpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceupkie.html">upkie</a></li><li class="navelem"><a class="el" href="namespaceupkie_1_1cpp.html">cpp</a></li><li class="navelem"><a class="el" href="namespaceupkie_1_1cpp_1_1spine.html">spine</a></li><li class="navelem"><a class="el" href="classupkie_1_1cpp_1_1spine_1_1Spine.html">Spine</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
