<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>upkie: upkie.envs.upkie_base_env.UpkieBaseEnv Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">upkie<span id="projectnumber">&#160;5.2.0</span>
   </div>
   <div id="projectbrief">Open-source wheeled biped robots</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">upkie.envs.upkie_base_env.UpkieBaseEnv Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Base class for Upkie environments.  
 <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4be7d838def163345101b019898dc867"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a4be7d838def163345101b019898dc867">__init__</a> (self, float <a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a1cc38c6e11f9b8bd2c5c3c4499ba7edc">fall_pitch</a>=1.0, Optional[float] <a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a0af239450ca67c0381e8898af17b174d">frequency</a>=200.0, bool frequency_checks=True, Optional[<a class="el" href="classupkie_1_1utils_1_1robot__state_1_1RobotState.html">RobotState</a>] <a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a56641dc3888c28cda9ec0777f048db7d">init_state</a>=None, bool regulate_frequency=True, str shm_name=&quot;/upkie&quot;, Optional[dict] spine_config=None, int spine_retries=10)</td></tr>
<tr class="memdesc:a4be7d838def163345101b019898dc867"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize environment.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a4be7d838def163345101b019898dc867">More...</a><br /></td></tr>
<tr class="separator:a4be7d838def163345101b019898dc867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad327651e6ae5f0560b5e5b8c7e16acff"><td class="memItemLeft" align="right" valign="top"><a id="ad327651e6ae5f0560b5e5b8c7e16acff" name="ad327651e6ae5f0560b5e5b8c7e16acff"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__del__</b> (self)</td></tr>
<tr class="memdesc:ad327651e6ae5f0560b5e5b8c7e16acff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the spine when deleting the environment instance. <br /></td></tr>
<tr class="separator:ad327651e6ae5f0560b5e5b8c7e16acff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2599a019384b06a16703531c2e52dcc6"><td class="memItemLeft" align="right" valign="top"><a id="a2599a019384b06a16703531c2e52dcc6" name="a2599a019384b06a16703531c2e52dcc6"></a>
None&#160;</td><td class="memItemRight" valign="bottom"><b>close</b> (self)</td></tr>
<tr class="memdesc:a2599a019384b06a16703531c2e52dcc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the spine properly. <br /></td></tr>
<tr class="separator:a2599a019384b06a16703531c2e52dcc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26d4d755da82237864eda88cd29334fa"><td class="memItemLeft" align="right" valign="top"><a id="a26d4d755da82237864eda88cd29334fa" name="a26d4d755da82237864eda88cd29334fa"></a>
Optional[float]&#160;</td><td class="memItemRight" valign="bottom"><b>dt</b> (self)</td></tr>
<tr class="memdesc:a26d4d755da82237864eda88cd29334fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regulated period of the control loop in seconds, or <code>None</code> if there is no loop frequency regulation. <br /></td></tr>
<tr class="separator:a26d4d755da82237864eda88cd29334fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af239450ca67c0381e8898af17b174d"><td class="memItemLeft" align="right" valign="top"><a id="a0af239450ca67c0381e8898af17b174d" name="a0af239450ca67c0381e8898af17b174d"></a>
Optional[float]&#160;</td><td class="memItemRight" valign="bottom"><b>frequency</b> (self)</td></tr>
<tr class="memdesc:a0af239450ca67c0381e8898af17b174d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regulated frequency of the control loop in Hz, or <code>None</code> if there is no loop frequency regulation. <br /></td></tr>
<tr class="separator:a0af239450ca67c0381e8898af17b174d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab503d17424ef6139fa81cd3d43616787"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#ab503d17424ef6139fa81cd3d43616787">update_init_rand</a> (self, **kwargs)</td></tr>
<tr class="memdesc:ab503d17424ef6139fa81cd3d43616787"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update initial-state randomization.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#ab503d17424ef6139fa81cd3d43616787">More...</a><br /></td></tr>
<tr class="separator:ab503d17424ef6139fa81cd3d43616787"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49de0450c154a72200a91496f654ed7b"><td class="memItemLeft" align="right" valign="top">Tuple[np.ndarray, dict]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a49de0450c154a72200a91496f654ed7b">reset</a> (self, *Optional[int] seed=None, Optional[dict] options=None)</td></tr>
<tr class="memdesc:a49de0450c154a72200a91496f654ed7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the spine and get an initial observation.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a49de0450c154a72200a91496f654ed7b">More...</a><br /></td></tr>
<tr class="separator:a49de0450c154a72200a91496f654ed7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90f46661990c9ee57cf3db2bb0774d26"><td class="memItemLeft" align="right" valign="top">Tuple[np.ndarray, float, bool, bool, dict]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a90f46661990c9ee57cf3db2bb0774d26">step</a> (self, np.ndarray action)</td></tr>
<tr class="memdesc:a90f46661990c9ee57cf3db2bb0774d26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run one timestep of the environment's dynamics.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a90f46661990c9ee57cf3db2bb0774d26">More...</a><br /></td></tr>
<tr class="separator:a90f46661990c9ee57cf3db2bb0774d26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6d49caa5b6ee4569518dc27cb75f8e4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#ac6d49caa5b6ee4569518dc27cb75f8e4">detect_fall</a> (self, dict spine_observation)</td></tr>
<tr class="memdesc:ac6d49caa5b6ee4569518dc27cb75f8e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detect a fall based on the base-to-world pitch angle.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#ac6d49caa5b6ee4569518dc27cb75f8e4">More...</a><br /></td></tr>
<tr class="separator:ac6d49caa5b6ee4569518dc27cb75f8e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a65ff93ee171c00abcbece4cc58c89"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#af2a65ff93ee171c00abcbece4cc58c89">parse_first_observation</a> (self, dict spine_observation)</td></tr>
<tr class="memdesc:af2a65ff93ee171c00abcbece4cc58c89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse first observation after the spine interface is initialized.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#af2a65ff93ee171c00abcbece4cc58c89">More...</a><br /></td></tr>
<tr class="separator:af2a65ff93ee171c00abcbece4cc58c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5172da18c6944f80bd9ec59c898bee"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#acd5172da18c6944f80bd9ec59c898bee">get_env_observation</a> (self, dict spine_observation)</td></tr>
<tr class="memdesc:acd5172da18c6944f80bd9ec59c898bee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract environment observation from spine observation dictionary.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#acd5172da18c6944f80bd9ec59c898bee">More...</a><br /></td></tr>
<tr class="separator:acd5172da18c6944f80bd9ec59c898bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e4f2c1de7e487c6d2aa06aca00c173c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a9e4f2c1de7e487c6d2aa06aca00c173c">get_reward</a> (self, observation, action)</td></tr>
<tr class="memdesc:a9e4f2c1de7e487c6d2aa06aca00c173c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reward from observation and action.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a9e4f2c1de7e487c6d2aa06aca00c173c">More...</a><br /></td></tr>
<tr class="separator:a9e4f2c1de7e487c6d2aa06aca00c173c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1f0dc9d7ee392aa37eb428269093274"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1f0dc9d7ee392aa37eb428269093274">get_spine_action</a> (self, action)</td></tr>
<tr class="memdesc:aa1f0dc9d7ee392aa37eb428269093274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert environment action to a spine action dictionary.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aa1f0dc9d7ee392aa37eb428269093274">More...</a><br /></td></tr>
<tr class="separator:aa1f0dc9d7ee392aa37eb428269093274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f46d6e95abb3f942a659a493c01d11"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a54f46d6e95abb3f942a659a493c01d11">log</a> (self, str name, Any entry)</td></tr>
<tr class="memdesc:a54f46d6e95abb3f942a659a493c01d11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log a new entry to the "log" key of the action dictionary.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a54f46d6e95abb3f942a659a493c01d11">More...</a><br /></td></tr>
<tr class="separator:a54f46d6e95abb3f942a659a493c01d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7d12a897177888525b7d5e460e57ab"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aae7d12a897177888525b7d5e460e57ab">bullet_extra</a> (self, dict bullet_action)</td></tr>
<tr class="memdesc:aae7d12a897177888525b7d5e460e57ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepend for the next step an extra action for the Bullet spine.  <a href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#aae7d12a897177888525b7d5e460e57ab">More...</a><br /></td></tr>
<tr class="separator:aae7d12a897177888525b7d5e460e57ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a1cc38c6e11f9b8bd2c5c3c4499ba7edc"><td class="memItemLeft" align="right" valign="top"><a id="a1cc38c6e11f9b8bd2c5c3c4499ba7edc" name="a1cc38c6e11f9b8bd2c5c3c4499ba7edc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>fall_pitch</b></td></tr>
<tr class="memdesc:a1cc38c6e11f9b8bd2c5c3c4499ba7edc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fall detection pitch angle, in radians. <br /></td></tr>
<tr class="separator:a1cc38c6e11f9b8bd2c5c3c4499ba7edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56641dc3888c28cda9ec0777f048db7d"><td class="memItemLeft" align="right" valign="top"><a id="a56641dc3888c28cda9ec0777f048db7d" name="a56641dc3888c28cda9ec0777f048db7d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>init_state</b></td></tr>
<tr class="memdesc:a56641dc3888c28cda9ec0777f048db7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial state for the floating base of the robot, which may be randomized upon resets. <br /></td></tr>
<tr class="separator:a56641dc3888c28cda9ec0777f048db7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7b7f2983aa32619bc3c0306585e2863"><td class="memItemLeft" align="right" valign="top"><a id="af7b7f2983aa32619bc3c0306585e2863" name="af7b7f2983aa32619bc3c0306585e2863"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>model</b></td></tr>
<tr class="memdesc:af7b7f2983aa32619bc3c0306585e2863"><td class="mdescLeft">&#160;</td><td class="mdescRight">Robot model read from its URDF description. <br /></td></tr>
<tr class="separator:af7b7f2983aa32619bc3c0306585e2863"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Base class for Upkie environments. </p>
<dl class="section note"><dt>Note</dt><dd>This environment is made to run on a single CPU thread rather than on GPU/TPU. The downside for reinforcement learning is that computations are not massively parallel. The upside is that it simplifies deployment to the real robot, as it relies on the same spine interface that runs on Upkie. </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4be7d838def163345101b019898dc867" name="a4be7d838def163345101b019898dc867"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be7d838def163345101b019898dc867">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>fall_pitch</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[float] &#160;</td>
          <td class="paramname"><em>frequency</em> = <code>200.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>frequency_checks</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[<a class="el" href="classupkie_1_1utils_1_1robot__state_1_1RobotState.html">RobotState</a>] &#160;</td>
          <td class="paramname"><em>init_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>regulate_frequency</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str &#160;</td>
          <td class="paramname"><em>shm_name</em> = <code>&quot;/upkie&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[dict] &#160;</td>
          <td class="paramname"><em>spine_config</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>spine_retries</em> = <code>10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize environment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fall_pitch</td><td>Fall detection pitch angle, in radians. </td></tr>
    <tr><td class="paramname">frequency</td><td>Regulated frequency of the control loop, in Hz. Can be prescribed even when <code>regulate_frequency</code> is unset, in which case <code>self.dt</code> will be defined but the loop frequency will not be regulated. </td></tr>
    <tr><td class="paramname">frequency_checks</td><td>If <code>regulate_frequency</code> is set and this parameter is true (default), a warning is issued every time the control loop runs slower than the desired <code>frequency</code>. Set this parameter to false to disable these warnings. </td></tr>
    <tr><td class="paramname">init_state</td><td>Initial state of the robot, only used in simulation. </td></tr>
    <tr><td class="paramname">regulate_frequency</td><td>If set (default), the environment will regulate the control loop frequency to the value prescribed in <code>frequency</code>. </td></tr>
    <tr><td class="paramname">shm_name</td><td>Name of shared-memory file to exchange with the spine. </td></tr>
    <tr><td class="paramname">spine_config</td><td>Additional spine configuration overriding the default <code>upkie.config.SPINE_CONFIG</code>. The combined configuration dictionary is sent to the spine at every :func:<code>reset</code>. </td></tr>
    <tr><td class="paramname">spine_retries</td><td>Number of times to try opening the shared-memory file to communicate with the spine.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SpineError</td><td>If the spine did not respond after the prescribed number of trials. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__servo__positions_1_1UpkieServoPositions.html#acb45430a9d460552cba48db0ea93f047">upkie.envs.upkie_servo_positions.UpkieServoPositions</a>, <a class="el" href="classupkie_1_1envs_1_1upkie__servo__torques_1_1UpkieServoTorques.html#a03569cc444ce088a912819f9e1c1f925">upkie.envs.upkie_servo_torques.UpkieServoTorques</a>, <a class="el" href="classupkie_1_1envs_1_1upkie__servos_1_1UpkieServos.html#a424a83ff96b7d4bfed782007484a198b">upkie.envs.upkie_servos.UpkieServos</a>, and <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#ab4e3662ca91182eeb389336185742890">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aae7d12a897177888525b7d5e460e57ab" name="aae7d12a897177888525b7d5e460e57ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7d12a897177888525b7d5e460e57ab">&#9670;&#160;</a></span>bullet_extra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.bullet_extra </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>bullet_action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepend for the next step an extra action for the Bullet spine. </p>
<p >This extra action can be for instance a set of external forces applied to some robot bodies.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bullet_action</td><td>Action dictionary processed by the Bullet spine. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac6d49caa5b6ee4569518dc27cb75f8e4" name="ac6d49caa5b6ee4569518dc27cb75f8e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6d49caa5b6ee4569518dc27cb75f8e4">&#9670;&#160;</a></span>detect_fall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool upkie.envs.upkie_base_env.UpkieBaseEnv.detect_fall </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>spine_observation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detect a fall based on the base-to-world pitch angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spine_observation</td><td>Observation dictionary with a "base_orientation" key. This requires the <a class="el" href="classupkie_1_1cpp_1_1observers_1_1BaseOrientation.html">upkie::cpp::observers::BaseOrientation</a> observer in the spine's observer pipeline. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if and only if a fall is detected. </dd></dl>

</div>
</div>
<a id="acd5172da18c6944f80bd9ec59c898bee" name="acd5172da18c6944f80bd9ec59c898bee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5172da18c6944f80bd9ec59c898bee">&#9670;&#160;</a></span>get_env_observation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def upkie.envs.upkie_base_env.UpkieBaseEnv.get_env_observation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>spine_observation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract environment observation from spine observation dictionary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spine_observation</td><td>Spine observation dictionary. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Environment observation. </dd></dl>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#a63ccb490dd46e7b14a2a04e270f563dd">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>, and <a class="el" href="classupkie_1_1envs_1_1upkie__servos_1_1UpkieServos.html#afe7bda5a7575cc479fa21a85345aa19f">upkie.envs.upkie_servos.UpkieServos</a>.</p>

</div>
</div>
<a id="a9e4f2c1de7e487c6d2aa06aca00c173c" name="a9e4f2c1de7e487c6d2aa06aca00c173c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e4f2c1de7e487c6d2aa06aca00c173c">&#9670;&#160;</a></span>get_reward()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float upkie.envs.upkie_base_env.UpkieBaseEnv.get_reward </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get reward from observation and action. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">observation</td><td>Environment observation. </td></tr>
    <tr><td class="paramname">action</td><td>Environment action. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reward. </dd></dl>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__servos_1_1UpkieServos.html#a5325bfa636dc53691fe15d7081c31f11">upkie.envs.upkie_servos.UpkieServos</a>, and <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#a1f5b195d6992cd7f7b141322e6b7c443">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>.</p>

</div>
</div>
<a id="aa1f0dc9d7ee392aa37eb428269093274" name="aa1f0dc9d7ee392aa37eb428269093274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1f0dc9d7ee392aa37eb428269093274">&#9670;&#160;</a></span>get_spine_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> dict upkie.envs.upkie_base_env.UpkieBaseEnv.get_spine_action </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert environment action to a spine action dictionary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>Environment action. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Spine action dictionary. </dd></dl>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__servos_1_1UpkieServos.html#aff4c0223e06e38afa2068d3bf9b69d24">upkie.envs.upkie_servos.UpkieServos</a>, and <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#a4d6d765759eba209f4717646a941d8cc">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>.</p>

</div>
</div>
<a id="a54f46d6e95abb3f942a659a493c01d11" name="a54f46d6e95abb3f942a659a493c01d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54f46d6e95abb3f942a659a493c01d11">&#9670;&#160;</a></span>log()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.log </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Any&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Log a new entry to the "log" key of the action dictionary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the entry. </td></tr>
    <tr><td class="paramname">entry</td><td>Dictionary to log along with the actual action. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af2a65ff93ee171c00abcbece4cc58c89" name="af2a65ff93ee171c00abcbece4cc58c89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a65ff93ee171c00abcbece4cc58c89">&#9670;&#160;</a></span>parse_first_observation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.parse_first_observation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>spine_observation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse first observation after the spine interface is initialized. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spine_observation</td><td>First observation.</td></tr>
  </table>
  </dd>
</dl>
<p>This method is an optional way for environments to record some state (abstracted away from the agnet) at reset. </p>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#a5e40aeca5b2997afd78acb2f70c9d1db">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>.</p>

</div>
</div>
<a id="a49de0450c154a72200a91496f654ed7b" name="a49de0450c154a72200a91496f654ed7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49de0450c154a72200a91496f654ed7b">&#9670;&#160;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[np.ndarray, dict] upkie.envs.upkie_base_env.UpkieBaseEnv.reset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*Optional[int] &#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[dict] &#160;</td>
          <td class="paramname"><em>options</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the spine and get an initial observation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seed</td><td>Number used to initialize the environmentâ€™s internal random number generator. </td></tr>
    <tr><td class="paramname">options</td><td>Currently unused. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><code>observation</code>: Initial vectorized observation, i.e. an element of the environment's <code>observation_space</code>.</li>
<li><code>info</code>: Dictionary with auxiliary diagnostic information. For Upkie this is the full observation dictionary sent by the spine. </li>
</ul>
</dd></dl>

<p>Reimplemented in <a class="el" href="classupkie_1_1envs_1_1upkie__ground__velocity_1_1UpkieGroundVelocity.html#ab77d2b114d9f227de34846886ba2764b">upkie.envs.upkie_ground_velocity.UpkieGroundVelocity</a>.</p>

</div>
</div>
<a id="a90f46661990c9ee57cf3db2bb0774d26" name="a90f46661990c9ee57cf3db2bb0774d26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90f46661990c9ee57cf3db2bb0774d26">&#9670;&#160;</a></span>step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[np.ndarray, float, bool, bool, dict] upkie.envs.upkie_base_env.UpkieBaseEnv.step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run one timestep of the environment's dynamics. </p>
<p >When the end of the episode is reached, you are responsible for calling <code><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a49de0450c154a72200a91496f654ed7b" title="Resets the spine and get an initial observation.">reset()</a></code> to reset the environment's state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>Action from the agent. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><code>observation</code>: Observation of the environment, i.e. an element of its <code>observation_space</code>.</li>
<li><code>reward</code>: Reward returned after taking the action.</li>
<li><code>terminated</code>: Whether the agent reached a terminal state, which can be a good or a bad thing. When true, the user needs to call :func:<code><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a49de0450c154a72200a91496f654ed7b" title="Resets the spine and get an initial observation.">reset()</a></code>.</li>
<li><code>truncated</code>: Whether the episode is reaching max number of steps. This boolean can signal a premature end of the episode, i.e. before a terminal state is reached. When true, the user needs to call :func:<code><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html#a49de0450c154a72200a91496f654ed7b" title="Resets the spine and get an initial observation.">reset()</a></code>.</li>
<li><code>info</code>: Dictionary with auxiliary diagnostic information. For us this is the full observation dictionary coming from the spine. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ab503d17424ef6139fa81cd3d43616787" name="ab503d17424ef6139fa81cd3d43616787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab503d17424ef6139fa81cd3d43616787">&#9670;&#160;</a></span>update_init_rand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None upkie.envs.upkie_base_env.UpkieBaseEnv.update_init_rand </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update initial-state randomization. </p>
<p >Keyword arguments are forwarded as is to <a class="el" href="classupkie_1_1utils_1_1robot__state__randomization_1_1RobotStateRandomization.html#a89e67ce737f68e5d4c06e71a66310c5b">upkie.utils.robot_state_randomization.RobotStateRandomization.update</a>. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>upkie/envs/upkie_base_env.py</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceupkie.html">upkie</a></li><li class="navelem"><a class="el" href="namespaceupkie_1_1envs.html">envs</a></li><li class="navelem"><b>upkie_base_env</b></li><li class="navelem"><a class="el" href="classupkie_1_1envs_1_1upkie__base__env_1_1UpkieBaseEnv.html">UpkieBaseEnv</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
